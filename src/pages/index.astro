---
import { getCollection } from "astro:content";
import ProjectCard from "~/components/project-card.astro";
import Socials from "~/components/socials.astro";
import Root from "~/layouts/root.astro";

const tags = new Set<string>();

let posts = await getCollection("posts");
posts.forEach((p) => p.data.tags?.forEach((t) => tags.add(t)));
posts.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
posts = posts.slice(0, 6);

const projects = await getCollection("projects");
projects.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<Root
  title="Zachary Robinson"
  description="My name's Zach. I'm a Computer Science major at the University of Maryland who's passionate about learning new technology and building cool stuff."
  keywords={Array.from(tags)}
>
  <p>Hey There!</p>

  <p>
    My name's Zach. I'm a Computer Science major at the <a
      href="https://umd.edu"
      target="_blank">University of Maryland</a
    > who's passionate about learning new technology and building cool stuff. I enjoy
    occasionally writing about my experiences and projects here on this site.
  </p>

  <Socials />

  <h2>Latest Posts</h2>

  <ul>
    {
      posts.map((post) => (
        <li>
          <time datetime={post.data.date.toISOString()}>
            {post.data.date.toISOString().split("T")[0]}
          </time>
          <a href={`/posts/${post.slug}`}>{post.data.title}</a>

          <p>{post.body.split(" ").slice(0, 30).join(" ")}...</p>
        </li>
      ))
    }
  </ul>

  <p>View all posts <a href="/posts">here</a>.</p>

  <h2>Featured Projects</h2>

  <ul>
    {
      projects.map((project) => (
        <li>
          <time datetime={project.data.date.toISOString()}>
            {project.data.date.toISOString().split("T")[0]}
          </time>
          <a href={project.data.deploymentURL} target="_blank">
            {project.data.title}
          </a>
          <p>{project.data.description}</p>
        </li>
      ))
    }
  </ul>

  <p>
    View all projects <a href="https://github.com/zsrobinson" target="_blank"
      >here</a
    >.
  </p>
</Root>

<style>
  h2 {
    margin-top: 32px;
  }
  time {
    font-family: monospace;
  }
  ul {
    list-style: none;
    padding: 0;
  }
  li > p {
    padding-left: 32px;
  }
  li > a,
  li > time {
    font-weight: 600;
  }
</style>
